# TODO
# - invites
# - remove role from myself?
# - authorization directives

## enums
enum SortableFields {
    user
}

enum SortDirection {
    asc
    desc
}

## Types
""" Holds additional information about the retrieved data """
type PageInfo {
    ownerCount: Int!
    totalCount: Int!
}

""" List of the users """
type UserConnection {
    user: [User!]!
    pageInfo: PageInfo
}

""" Represents an user """
type User {
    userId: String!
    email: String!
    firstName: String
    lastName: String
#    invitationOutstanding: Boolean!
}

""" Represents a role that can be granted to an user or group of users """
type Role {
    """ Is a human readable name of the role """
    displayName: String!
    """ Is an identifier of the role """
    technicalName: String!
}

""" Contains all roles that are granted to an user """
type GrantedUser {
    user: User!
    roles: [Role!]
}

""" Is a list of the users and their roles """
type GrantedUserConnection {
    users: [GrantedUser]
    """ a number of granted users in the list """
    pageInfo: PageInfo!
}

## Inputs
input Resource {
    name: String!
    namespace: String
}

""" Holds the information about a specific user and and a list of roles that should be assigned to the user """
input UserRoleChange {
    userId: String!
    roles: [String!]!
}
input SortByInput {
    field: SortableFields!
    direction: SortDirection!
}


# Query and Mutations
type Query {
    """ roles returns the list of assignable roles for a particular groupResource/resource e.g. What roles can be assigned for a specific core_platform-mesh_io_account"""
    roles(groupResource: String!, resource: Resource!, accountPath: String!): [Role]! # read_roles permission required get_iam_roles
    """ returns all users that have roles assigned for a particular groupResource/resource."""
    users(groupResource: String!, resource: Resource!, accountPath: String!, roleFilters: [String!], sortBy: SortByInput): [GrantedUserConnection]! # you need to be a "member" of the project get_iam_users
    """ returns a specific user by userId"""
    user(userId: String!): User # you need to be a "member" of the organization get_iam_users
    """ returns my user information"""
    me: User # only me can access this public
}


type Mutation {
    assignRolesToUsers(groupResource: String!, resource: Resource!, accountPath: String!, changes: [UserRoleChange!]!): Boolean! # manage_roles permission required manage_iam_roles
    removeRole(groupResource: String!, resource: Resource!, accountPath: String!, userId: String!, role: String!): Boolean! # manage_roles permission required manage_iam_roles
}
schema{
    query: Query
    mutation: Mutation
}